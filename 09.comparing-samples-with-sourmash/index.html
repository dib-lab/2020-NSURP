
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://dib-lab.github.io/2020-NSURP/09.comparing-samples-with-sourmash/">
      
      
        <link rel="prev" href="../08.taxonomic-discovery-with-sourmash/">
      
      
        <link rel="next" href="../11.experiment-challenge/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Comparing Samples with Sourmash - dib-lab NSURP project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#comparing-samples-with-sourmash" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="dib-lab NSURP project" class="md-header__button md-logo" aria-label="dib-lab NSURP project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dib-lab NSURP project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Comparing Samples with Sourmash
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dib-lab/2020-NSURP" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    2020-NSURP
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="dib-lab NSURP project" class="md-nav__button md-logo" aria-label="dib-lab NSURP project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82Z"/></svg>

    </a>
    dib-lab NSURP project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dib-lab/2020-NSURP" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    2020-NSURP
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Setup
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01.using-farm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up Farm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02.conda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Conda
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03.lab-notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keeping a Lab Notebook
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04.sourmash-tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Try Sourmash!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05.starting-a-work-session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting a Work Session
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    IBD Research Project
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            IBD Research Project
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06.download-assess-ibd-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download and Visually Assess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07.quality-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08.taxonomic-discovery-with-sourmash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taxonomic Discovery with Sourmash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Comparing Samples with Sourmash
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Comparing Samples with Sourmash
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#workspace-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Workspace Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculate-sourmash-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Calculate sourmash signatures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-sample-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Compare sample signatures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-the-comparison-using-sourmash-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize the comparison using sourmash plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-the-comparison-in-an-mds-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize the comparison in an MDS plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualize the comparison in an MDS plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-the-r-packages-ggplot2-and-ggrepel" class="md-nav__link">
    <span class="md-ellipsis">
      Install the R packages ggplot2 and ggrepel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-an-r-script-to-make-the-mds-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Download an R script to make the MDS plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-the-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      Run the R script
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.experiment-challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experiment Challenge
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Advanced Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.workflows-and-repeatability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automation, Workflows, and Repeatability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.angus-github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version Control with Git and GitHub
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#workspace-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Workspace Setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calculate-sourmash-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Calculate sourmash signatures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-sample-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Compare sample signatures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-the-comparison-using-sourmash-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize the comparison using sourmash plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualize-the-comparison-in-an-mds-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Visualize the comparison in an MDS plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Visualize the comparison in an MDS plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-the-r-packages-ggplot2-and-ggrepel" class="md-nav__link">
    <span class="md-ellipsis">
      Install the R packages ggplot2 and ggrepel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-an-r-script-to-make-the-mds-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Download an R script to make the MDS plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-the-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      Run the R script
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="comparing-samples-with-sourmash">Comparing Samples with Sourmash</h1>
<p>Many metagenomics projects are designed to assess the differences between microorganism composition between samples.
There are many ways to get at this question, but we can start by using k-mer profiles of the reads to quickly compare samples using <code>sourmash compare</code>.</p>
<h2 id="workspace-setup">Workspace Setup</h2>
<p>If you're starting a new work session on FARM, be sure to follow the instructions <a href="../05.starting-a-work-session/">here</a>.</p>
<p>First, let's make a directory that we will be working in:</p>
<pre><code>cd ~/2020-NSURP
mkdir -p sourmash-compare
cd sourmash-compare
</code></pre>
<blockquote>
<p>Note: we made a directory called <code>sourmash</code> for the <a href="../08.taxonomic-discovery-with-sourmash/">taxonomic discovery</a> module.
It helps to name files and folders with details that will help you remember what results are contained therein.
How could the prior module's folder name be changed to be more informative?</p>
</blockquote>
<h2 id="calculate-sourmash-signatures">Calculate sourmash signatures</h2>
<p>Now we can calculate signatures for each of the files. This will take 5 or 10 minutes to run</p>
<pre><code>for infile in ~/2020-NSURP/kmer-trim/*.kmertrim.fq.gz
do
    name=$(basename ${infile} .kmertrim.fq.gz)
    echo $name
    sourmash compute -k 21,31,51 --scaled 2000 --track-abundance --merge ${name} -o ${name}.kmertrim.sig ${infile}
done
</code></pre>
<blockquote>
<p>Note: Here we used bash <code>for loop</code> to compute signatures on each file with a single set of commands.
Go through this <a href="https://datacarpentry.org/shell-genomics/04-redirection/index.html">tutorial</a> to learn about loops!</p>
</blockquote>
<h2 id="compare-sample-signatures">Compare sample signatures</h2>
<p>Using these signatures, we can compare our samples.</p>
<pre><code>sourmash compare -k 31 -o IBD.kmertrim.compare.np --csv IBD.kmertrim.compare.csv --ignore-abundance *sig
</code></pre>
<p>Now let's plot! Sourmash has a built in plot utility that we can take advantage of.
The output is a heatmap.</p>
<h2 id="visualize-the-comparison-using-sourmash-plot">Visualize the comparison using sourmash plot</h2>
<pre><code>sourmash plot --labels IBD.kmertrim.compare.np
</code></pre>
<p>This command produces three <code>png</code> files:</p>
<pre><code>IBD.kmertrim.compare.np.hist.png
IBD.kmertrim.compare.np.dendro.png
IBD.kmertrim.compare.np.matrix.png
</code></pre>
<p>As usual, these files can be downloaded to your local computer with <code>scp</code></p>
<pre><code>scp -P 2022  -i /path/to/key/file username@farm.cse.ucdavis.edu:~/2020-NSURP/sourmash-compare/*.png ./
</code></pre>
<p>If you're on a mac using <code>zsh</code>, you may need to replace the <code>scp</code> with <code>noglob scp</code> in the command above.</p>
<p>If you're on windows, you may need to move the the files from the download location on your Linux shell over to the windows side of your computer before opening.</p>
<p>Once the files are on your local computer, double click to open each file. 
The <code>.matrix.png</code> is the heatmap file, which will show the pattern of similarity between samples</p>
<p>It should look like this:</p>
<p><img alt="sourmash compare matrix" src="../_static/IBD.kmertrim.compare.np.matrix.png" />.</p>
<p>What does this heatmap tell you about your samples?
For example, does it provide any information about which samples are from IBD patients, and which are from non-IBD patients?</p>
<h2 id="visualize-the-comparison-in-an-mds-plot">Visualize the comparison in an MDS plot</h2>
<p>We can use this output to make a Multidimensional Scaling plot. MDS plots are
commonly used in visualize similarities and differences between samples.
Here the strength is we used the k-mer content of all of our reads to calculate similarity.</p>
<h3 id="install-the-r-packages-ggplot2-and-ggrepel">Install the R packages ggplot2 and ggrepel</h3>
<p>Since this is conda, it will recognize that it needs to install R alongside these, and take care of that for you!
Usually you'll want to be careful of <em>which</em> version of R you're installing, but since we're just doing this one R command, we'll be a little lax about it.</p>
<pre><code>conda install r-ggplot2 r-ggrepel 
</code></pre>
<h3 id="download-an-r-script-to-make-the-mds-plot">Download an R script to make the MDS plot</h3>
<p>The script source is <a href="https://raw.githubusercontent.com/dib-lab/2020-NSURP/master/scripts/mds_plot.R">here</a> if you are interested!</p>
<pre><code>wget https://raw.githubusercontent.com/dib-lab/2020-NSURP/master/scripts/mds_plot.R
</code></pre>
<h3 id="run-the-r-script">Run the R script</h3>
<pre><code>Rscript mds_plot.R IBD.kmertrim.compare.csv IBD.kmertrim.compare.mds.pdf
</code></pre>
<p>This outputs a file <code>IBD.kmertrim.compare.mds.pdf</code>.
You can see that file by downloading to your computer.
It should look something like this:</p>
<p><img alt="mds plot of sourmash compare" src="../_static/IBD.kmertrim.compare.mds.png" />.</p>
<p>How do the samples cluster? How does this compare to our heatmap, generated by <code>sourmash plot</code>, above?</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 <a href="http://ivory.idyll.org/lab/">Lab for Data Intensive Biology</a> at UC Davis
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>